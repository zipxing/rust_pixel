# RustPixel Architecture Principles

RustPixel is a 2D game engine supporting both text-mode and graphics-mode rendering across multiple platforms. This document explains the core architecture and rendering principles.

## ğŸ® Game Loop Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MAIN GAME LOOP                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Context   â”‚â—„â”€â”€â–ºâ”‚     Game     â”‚â—„â”€â”€â–ºâ”‚   Asset Manager     â”‚ â”‚
â”‚  â”‚             â”‚    â”‚              â”‚    â”‚                     â”‚ â”‚
â”‚  â”‚ â€¢ stage     â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â€¢ ImgPix (.pix)     â”‚ â”‚
â”‚  â”‚ â€¢ state     â”‚    â”‚ â”‚  Model   â”‚ â”‚    â”‚ â€¢ ImgEsc (.esc)     â”‚ â”‚
â”‚  â”‚ â€¢ rand      â”‚    â”‚ â”‚          â”‚ â”‚    â”‚ â€¢ ImgSsf (.ssf)     â”‚ â”‚
â”‚  â”‚ â€¢ events    â”‚    â”‚ â”‚ â€¢ init() â”‚ â”‚    â”‚ â€¢ Async Loading     â”‚ â”‚
â”‚  â”‚ â€¢ adapter   â”‚    â”‚ â”‚ â€¢ update â”‚ â”‚    â”‚                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚ â€¢ handle*â”‚ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                            â”‚
â”‚                     â”‚              â”‚                            â”‚
â”‚                     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                     â”‚ â”‚  Render  â”‚ â”‚    â”‚   Event System      â”‚ â”‚
â”‚                     â”‚ â”‚          â”‚ â”‚    â”‚                     â”‚ â”‚
â”‚                     â”‚ â”‚ â€¢ init() â”‚ â”‚    â”‚ â€¢ Global Timer      â”‚ â”‚
â”‚                     â”‚ â”‚ â€¢ draw() â”‚ â”‚â—„â”€â”€â–ºâ”‚ â€¢ Event Center      â”‚ â”‚
â”‚                     â”‚ â”‚ â€¢ handle*â”‚ â”‚    â”‚ â€¢ Input Events      â”‚ â”‚
â”‚                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                     â”‚ â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Flow: Context.stage â†’ Model.update() â†’ Render.draw() â†’ Platform Adapter
```

### Core Traits

- **Model**: Manages game state, logic, and input handling
- **Render**: Handles visual output and UI rendering  
- **Game**: Orchestrates the main loop and coordinates Model/Render
- **Context**: Shared state container with adapters and resources

## ğŸ–¥ï¸ Multi-Platform Adapter Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RENDER ADAPTERS                           â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  TEXT MODE      â”‚  â”‚  GRAPHICS MODE  â”‚  â”‚   WEB MODE      â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚ CrosstermAdapterâ”‚  â”‚   SdlAdapter    â”‚  â”‚   WebAdapter    â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚ â€¢ Terminal I/O  â”‚  â”‚ â€¢ SDL2 + OpenGL â”‚  â”‚ â€¢ WebGL + WASM  â”‚ â”‚
â”‚  â”‚ â€¢ ASCII/Unicode â”‚  â”‚ â€¢ PETSCII chars â”‚  â”‚ â€¢ Browser       â”‚ â”‚
â”‚  â”‚ â€¢ Double Buffer â”‚  â”‚ â€¢ Texture Atlas â”‚  â”‚ â€¢ JavaScript    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ WINIT ADAPTERS  â”‚  â”‚   WGPU MODE     â”‚                      â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚                      â”‚
â”‚  â”‚WinitGlowAdapter â”‚  â”‚WinitWgpuAdapter â”‚                      â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚                      â”‚
â”‚  â”‚ â€¢ Winit + Glow  â”‚  â”‚ â€¢ Modern GPU    â”‚                      â”‚
â”‚  â”‚ â€¢ Cross Platformâ”‚  â”‚ â€¢ Vulkan/Metal  â”‚                      â”‚
â”‚  â”‚ â€¢ OpenGL ES     â”‚  â”‚ â€¢ Compute Shaderâ”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Unified Interface: draw_all_graph() â†’ Platform-Specific Rendering
```

## ğŸ¨ Rendering Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RENDERING PIPELINE                         â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        PANEL                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   Layer 0   â”‚ â”‚   Layer 1   â”‚ â”‚      Layer N...      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Sprites    â”‚ â”‚  Sprites    â”‚ â”‚      Sprites         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚Sprite 0 â”‚ â”‚ â”‚ â”‚Sprite 0 â”‚ â”‚ â”‚  â”‚Sprite 0 â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚         â”‚ â”‚ â”‚ â”‚         â”‚ â”‚ â”‚  â”‚         â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚ Buffer  â”‚ â”‚ â”‚ â”‚ Buffer  â”‚ â”‚ â”‚  â”‚ Buffer  â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚         â”‚ â”‚ â”‚ â”‚         â”‚ â”‚ â”‚  â”‚         â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚â”‚ Cells â”‚â”‚ â”‚ â”‚ â”‚â”‚ Cells â”‚â”‚ â”‚ â”‚  â”‚â”‚ Cells â”‚â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚  â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚Sprite 1 â”‚ â”‚ â”‚ â”‚Sprite 1 â”‚ â”‚ â”‚  â”‚Sprite 1 â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   ...   â”‚ â”‚ â”‚ â”‚   ...   â”‚ â”‚ â”‚  â”‚   ...   â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚                 DOUBLE BUFFER                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   Buffer 0  â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚   Buffer 1  â”‚        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ (Previous)  â”‚              â”‚ (Current)   â”‚        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â†“                               â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                        â”‚   ADAPTER   â”‚                         â”‚
â”‚                        â”‚             â”‚                         â”‚
â”‚                        â”‚ Platform-   â”‚                         â”‚
â”‚                        â”‚ Specific    â”‚                         â”‚
â”‚                        â”‚ Rendering   â”‚                         â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cell Structure

```
Cell {
    symbol: String,     // Character or symbol index
    fg: Color,         // Foreground color
    bg: Color,         // Background color (texture in graphics)  
    modifier: Modifier, // Bold, italic, etc.
    tex: u8,           // Texture ID (graphics mode only)
}
```

## ğŸ“Ÿ Text Mode Rendering

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TEXT MODE FLOW                           â”‚
â”‚                                                               â”‚
â”‚  Panel Layers â†’ Merge Sprites â†’ Main Buffer â†’ Double Buffer   â”‚
â”‚       â†“              â†“              â†“              â†“          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Layer 0  â”‚    â”‚ Sprite  â”‚    â”‚ Main    â”‚    â”‚Previous â”‚     â”‚
â”‚  â”‚Sprites  â”‚â”€â”€â”€â–ºâ”‚ Merging â”‚â”€â”€â”€â–ºâ”‚ Buffer  â”‚â”€â”€â”€â–ºâ”‚ vs      â”‚     â”‚
â”‚  â”‚Layer 1  â”‚    â”‚ by      â”‚    â”‚ (Cells) â”‚    â”‚Current  â”‚     â”‚
â”‚  â”‚ ...     â”‚    â”‚ Weight  â”‚    â”‚         â”‚    â”‚ Buffer  â”‚     â”‚
â”‚  â”‚Layer N  â”‚    â”‚         â”‚    â”‚         â”‚    â”‚         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                     â†“         â”‚
â”‚                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                              â”‚  Diff   â”‚      â”‚
â”‚                                              â”‚ Detect  â”‚      â”‚
â”‚                                              â”‚         â”‚      â”‚
â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                     â†“         â”‚
â”‚                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                              â”‚Crosstermâ”‚      â”‚
â”‚                                              â”‚Terminal â”‚      â”‚
â”‚                                              â”‚ Output  â”‚      â”‚
â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Features:
â€¢ Full Unicode support (emojis, symbols)
â€¢ ANSI color and styling
â€¢ Efficient diff-based updates
â€¢ Cross-platform terminal compatibility
```

## ğŸ® Graphics Mode Rendering

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GRAPHICS MODE PIPELINE                       â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  REGULAR LAYERS â”‚                    â”‚   PIXEL LAYERS      â”‚  â”‚
â”‚ â”‚                 â”‚                    â”‚                     â”‚  â”‚
â”‚ â”‚  Sprite â†’ Cell  â”‚                    â”‚  Pixel Sprites      â”‚  â”‚
â”‚ â”‚  Collections    â”‚                    â”‚  (Pixel-level       â”‚  â”‚
â”‚ â”‚                 â”‚                    â”‚   movement)         â”‚  â”‚
â”‚ â”‚  Background/UI  â”‚                    â”‚  Transparency       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                                       â”‚              â”‚
â”‚          â–¼                                       â–¼              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                   RENDER BUFFER                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  Vec<RenderCell> {                                          â”‚ â”‚
â”‚ â”‚    fcolor: (f32, f32, f32, f32),   // Foreground RGBA       â”‚ â”‚
â”‚ â”‚    bcolor: Option<(...)>,          // Background (optional) â”‚ â”‚
â”‚ â”‚    texsym: usize,                  // Texture symbol index  â”‚ â”‚
â”‚ â”‚    x, y: f32,                      // Position              â”‚ â”‚
â”‚ â”‚    w, h: u32,                      // Dimensions            â”‚ â”‚
â”‚ â”‚    angle: f32,                     // Rotation              â”‚ â”‚
â”‚ â”‚    cx, cy: f32,                    // Center point          â”‚ â”‚
â”‚ â”‚  }                                                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                     GPU SHADERS                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚ â”‚  â”‚   Symbols   â”‚  â”‚ Transition  â”‚  â”‚     General2D       â”‚  â”‚ â”‚
â”‚ â”‚  â”‚   Shader    â”‚  â”‚   Shader    â”‚  â”‚     Shader          â”‚  â”‚ â”‚
â”‚ â”‚  â”‚             â”‚  â”‚             â”‚  â”‚                     â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â€¢ Instanced â”‚  â”‚ â€¢ Mix two   â”‚  â”‚ â€¢ Texture to        â”‚  â”‚ â”‚
â”‚ â”‚  â”‚   Rendering â”‚  â”‚   textures  â”‚  â”‚   Screen            â”‚  â”‚ â”‚
â”‚ â”‚  â”‚ â€¢ Texture   â”‚  â”‚ â€¢ Effects   â”‚  â”‚ â€¢ Final output      â”‚  â”‚ â”‚
â”‚ â”‚  â”‚   Atlas     â”‚  â”‚ â€¢ Blending  â”‚  â”‚                     â”‚  â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚ Platform Output â”‚                          â”‚
â”‚                    â”‚                 â”‚                          â”‚
â”‚                    â”‚ â€¢ SDL2 Window   â”‚                          â”‚
â”‚                    â”‚ â€¢ Winit Window  â”‚                          â”‚
â”‚                    â”‚ â€¢ WebGL Canvas  â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Texture Atlas System

```
Texture Files:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   c64l.png  â”‚   c64u.png  â”‚  c64e1.png  â”‚  c64e2.png  â”‚
â”‚  (tex=0)    â”‚   (tex=1)   â”‚   (tex=2)   â”‚   (tex=3)   â”‚
â”‚             â”‚             â”‚             â”‚             â”‚
â”‚ Small case  â”‚ Upper case  â”‚ Extension 1 â”‚ Extension 2 â”‚
â”‚ C64 chars   â”‚ C64 chars   â”‚ Custom      â”‚ Custom      â”‚
â”‚             â”‚             â”‚             â”‚             â”‚
â”‚ 16x16 grid  â”‚ 16x16 grid  â”‚ 16x16 grid  â”‚ 16x16 grid  â”‚
â”‚ 256 symbols â”‚ 256 symbols â”‚ 256 symbols â”‚ 256 symbols â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Unicode Range: 0x2200 ~ 0x22FF maps to texture indices
```

## ğŸ¯ Asset Management System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ASSET PIPELINE                             â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   .pix      â”‚    â”‚   .esc      â”‚    â”‚       .ssf          â”‚  â”‚
â”‚  â”‚   Files     â”‚    â”‚   Files     â”‚    â”‚     Files           â”‚  â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                     â”‚  â”‚
â”‚  â”‚ Graphics    â”‚    â”‚ Terminal    â”‚    â”‚ Sequence Frames     â”‚  â”‚
â”‚  â”‚ Mode Art    â”‚    â”‚ Mode Art    â”‚    â”‚ Animation           â”‚  â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                     â”‚  â”‚
â”‚  â”‚ Cell Data   â”‚    â”‚ ESC + UTF-8 â”‚    â”‚ Multiple Frames     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                   â”‚                     â”‚             â”‚
â”‚         â–¼                   â–¼                     â–¼             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   ASSET MANAGER                            â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   ImgPix    â”‚  â”‚   ImgEsc    â”‚  â”‚      ImgSsf         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ AssetBase { â”‚  â”‚ AssetBase { â”‚  â”‚   AssetBase {       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   location  â”‚  â”‚   location  â”‚  â”‚     location        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   raw_data  â”‚  â”‚   raw_data  â”‚  â”‚     raw_data        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   buffers   â”‚  â”‚   buffers   â”‚  â”‚     buffers[]       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   state     â”‚  â”‚   state     â”‚  â”‚     frame_count     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ }           â”‚  â”‚ }           â”‚  â”‚     state           â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   }                 â”‚ â”‚ â”‚
â”‚  â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    LOADING STATES                          â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚     Loading â†’ Parsing â†’ Ready                              â”‚ â”‚
â”‚  â”‚        â”‚         â”‚        â”‚                                â”‚ â”‚
â”‚  â”‚        â–¼         â–¼        â–¼                                â”‚ â”‚
â”‚  â”‚    Fetch     Parse     Available                           â”‚ â”‚
â”‚  â”‚    Data      Buffer    for Use                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Features:
â€¢ Async loading (Native: file I/O, Web: JavaScript fetch)
â€¢ Cross-platform path resolution
â€¢ Efficient buffer caching
â€¢ State-based loading management
```

## ğŸ”§ Event System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       EVENT SYSTEM                               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    EVENT CENTER                             â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚     HashMap<String, HashMap<String, bool>>                  â”‚ â”‚
â”‚  â”‚            â”‚              â”‚         â”‚                       â”‚ â”‚
â”‚  â”‚        Event Name    Function   Triggered                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚   Register  â”‚    â”‚    Emit     â”‚    â”‚     Check       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ event_      â”‚    â”‚ event_      â”‚    â”‚ event_          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ register()  â”‚    â”‚ emit()      â”‚    â”‚ check()         â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    TIMER SYSTEM                             â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚     HashMap<String, Timer>                                  â”‚ â”‚
â”‚  â”‚            â”‚         â”‚                                      â”‚ â”‚
â”‚  â”‚       Timer Name   Config                                   â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚   Create    â”‚    â”‚   Update    â”‚    â”‚     Query       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚             â”‚    â”‚             â”‚    â”‚                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ timer_      â”‚    â”‚ timer_      â”‚    â”‚ timer_          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ create()    â”‚    â”‚ update()    â”‚    â”‚ check()         â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   INPUT EVENTS                              â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Platform â†’ Unified Event â†’ Context.input_events            â”‚ â”‚
â”‚  â”‚     â”‚              â”‚               â”‚                        â”‚ â”‚
â”‚  â”‚     â–¼              â–¼               â–¼                        â”‚ â”‚
â”‚  â”‚  SDL/Web/      Event Enum      Vec<Event>                   â”‚ â”‚
â”‚  â”‚  Terminal      â€¢ Key           in Context                   â”‚ â”‚
â”‚  â”‚  Input         â€¢ Mouse                                      â”‚ â”‚
â”‚  â”‚                â€¢ Window                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Performance Optimizations

### WGPU Modern Graphics Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       WGPU PIPELINE                            â”‚
â”‚                                                                â”‚
â”‚  CPU Side                           GPU Side                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Rust      â”‚                   â”‚       Shaders           â”‚ â”‚
â”‚  â”‚   Game      â”‚    Buffer         â”‚                         â”‚ â”‚
â”‚  â”‚   Logic     â”‚â”€â”€â”€â–º Upload  â”€â”€â”€â”€â–º â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚             â”‚                   â”‚  â”‚  Vertex Shader      â”‚â”‚ â”‚
â”‚  â”‚ RenderCell  â”‚                   â”‚  â”‚  Fragment Shader    â”‚â”‚ â”‚
â”‚  â”‚ Generation  â”‚                   â”‚  â”‚  Compute Shader     â”‚â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚                                    â”‚           â”‚             â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚           â–¼             â”‚ â”‚
â”‚  â”‚   Command   â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚   Buffer    â”‚â”€â”€â”€â”€Vulkan/â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚    GPU Memory       â”‚â”‚ â”‚
â”‚  â”‚ Recording   â”‚    Metal/         â”‚  â”‚                     â”‚â”‚ â”‚
â”‚  â”‚             â”‚    DX12           â”‚  â”‚  â€¢ Vertex Buffers   â”‚â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚  â€¢ Textures         â”‚â”‚ â”‚
â”‚                                    â”‚  â”‚  â€¢ Uniform Buffers  â”‚â”‚ â”‚
â”‚                                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
â€¢ Modern GPU API (Vulkan, Metal, DX12)
â€¢ Compute shader support
â€¢ Better memory management
â€¢ Cross-platform compatibility
```

### Rendering Optimizations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OPTIMIZATION STRATEGIES                     â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ DOUBLE BUFFER   â”‚  â”‚ INSTANCED       â”‚  â”‚ TEXTURE ATLAS   â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚ RENDERING       â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚ â€¢ Diff Detectionâ”‚  â”‚                 â”‚  â”‚ â€¢ Batch Symbols â”‚ â”‚
â”‚  â”‚ â€¢ Minimal       â”‚  â”‚ â€¢ GPU Instancingâ”‚  â”‚ â€¢ Reduce        â”‚ â”‚
â”‚  â”‚   Updates       â”‚  â”‚ â€¢ Single Draw   â”‚  â”‚   Draw Calls    â”‚ â”‚
â”‚  â”‚ â€¢ Flicker-free  â”‚  â”‚   Call          â”‚  â”‚ â€¢ Memory        â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚ â€¢ Efficient     â”‚  â”‚   Efficiency    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ OBJECT POOLING  â”‚  â”‚ LAZY LOADING    â”‚  â”‚ CONDITIONAL     â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚ COMPILATION     â”‚ â”‚
â”‚  â”‚ â€¢ Reuse Objects â”‚  â”‚ â€¢ Load on       â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚ â€¢ Reduce        â”‚  â”‚   Demand        â”‚  â”‚ â€¢ Platform      â”‚ â”‚
â”‚  â”‚   Allocations   â”‚  â”‚ â€¢ Async Assets  â”‚  â”‚   Specific      â”‚ â”‚
â”‚  â”‚ â€¢ Memory        â”‚  â”‚ â€¢ Progressive   â”‚  â”‚ â€¢ Feature       â”‚ â”‚
â”‚  â”‚   Efficiency    â”‚  â”‚   Loading       â”‚  â”‚   Flags         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”— Integration Points

### Macro System

```rust
// pixel_game! macro simplifies game creation
pixel_game!(MyGame);

// Generates:
// - mod model;
// - mod render_graphics; (or render_terminal)
// - Game initialization boilerplate
// - Platform-specific compilation

// asset2sprite! macro for easy asset loading
asset2sprite!(sprite, "path/to/asset.pix", ctx);
```

### Cross-Platform Features

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PLATFORM FEATURES                             â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Desktop   â”‚ â”‚     Web     â”‚ â”‚   Mobile    â”‚ â”‚ Terminal  â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚           â”‚ â”‚
â”‚  â”‚ â€¢ SDL2      â”‚ â”‚ â€¢ WebGL     â”‚ â”‚ â€¢ Touch     â”‚ â”‚ â€¢ SSH     â”‚ â”‚
â”‚  â”‚ â€¢ Winit     â”‚ â”‚ â€¢ WASM      â”‚ â”‚ â€¢ Sensors   â”‚ â”‚ â€¢ ASCII   â”‚ â”‚
â”‚  â”‚ â€¢ Native    â”‚ â”‚ â€¢ Browser   â”‚ â”‚ â€¢ Platform  â”‚ â”‚ â€¢ Colors  â”‚ â”‚
â”‚  â”‚   Audio     â”‚ â”‚   APIs      â”‚ â”‚   Specific  â”‚ â”‚ â€¢ Unicode â”‚ â”‚
â”‚  â”‚ â€¢ File I/O  â”‚ â”‚ â€¢ Canvas    â”‚ â”‚             â”‚ â”‚           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  Common Interface: Context + Adapters + Asset Management       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

This architecture enables RustPixel to provide consistent game development experience across platforms while leveraging platform-specific optimizations where beneficial.
